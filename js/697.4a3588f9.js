(globalThis["webpackChunktamponati_client"]=globalThis["webpackChunktamponati_client"]||[]).push([[697],{3245:(e,a,t)=>{"use strict";t.d(a,{Z:()=>d,e:()=>o});var l=t(4562);const d={id:null,nomecompleto:"",tipo:null},o=(0,l.r8)((()=>(0,l.y$)("vue-tamponati",{...d},sessionStorage)))},7697:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>y});var l=t(3673),d=t(8880),o=t(2323);const r={class:"q-pa-md"},u=(0,l.Uk)("Data"),i=(0,l.Uk)("Q.ta Tamponi"),n=(0,l.Uk)("Action");function s(e,a,t,s,m,c){const f=(0,l.up)("q-date"),p=(0,l.up)("q-popup-proxy"),w=(0,l.up)("q-icon"),D=(0,l.up)("q-input"),Y=(0,l.up)("q-item-label"),v=(0,l.up)("q-item-section"),_=(0,l.up)("q-btn"),W=(0,l.up)("q-item"),b=(0,l.up)("q-list"),q=(0,l.up)("q-form"),Z=(0,l.Q2)("ripple");return(0,l.wg)(),(0,l.j4)("div",r,[(0,l.Wm)(q,{ref:"formRef",onSubmit:(0,d.iM)(e.addRow,["prevent"])},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{class:"rounded-borders q-my-md",bordered:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:"items-start"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(D,{modelValue:e.register.data,"onUpdate:modelValue":a[3]||(a[3]=a=>e.register.data=a),outlined:"",label:"Data",dense:"",mask:"##/##/####",rules:[e=>/^-?[0-3]\d\/[0-1]\d\/[\d]+$/.test(e)||"Campo Richiesto",a=>e.checkMajToday(a)||"La Data non deve essere nel passato"]},{append:(0,l.w5)((()=>[(0,l.Wm)(w,{name:"event",class:"cursor-pointer"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{ref:"qDateProxy"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:e.register.data,"onUpdate:modelValue":[a[1]||(a[1]=a=>e.register.data=a),a[2]||(a[2]=()=>e.$refs.qDateProxy.hide())],mask:"DD/MM/YYYY",options:e.limitDateFn},null,8,["modelValue","options"])])),_:1},512)])),_:1})])),_:1},8,["modelValue","rules"])])),_:1})])),_:1}),(0,l.Wm)(v,{class:"text-weight-medium"},{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(D,{ref:"qtaRef",modelValue:e.register.qta,"onUpdate:modelValue":a[4]||(a[4]=a=>e.register.qta=a),modelModifiers:{number:!0},outlined:"",label:"QuantitÃ ",dense:"",rules:[e=>!!e||"Campo Richiesto"]},null,8,["modelValue","rules"])])),_:1})])),_:1}),(0,l.Wm)(v,{side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Y,{class:"text-black"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{type:"submit",icon:"add",flat:"",round:"",color:"primary"})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"]),(0,l.Wm)(b,{class:"rounded-borders relative-position",bordered:"",separator:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:"text-weight-medium"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[u])),_:1})])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[i])),_:1})])),_:1}),(0,l.Wm)(v,{class:"col-2 text-black",side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[n])),_:1})])),_:1})])),_:1}),(0,l.Wm)(d.W3,{name:"scale","move-class":"move-transition"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(e.sortedCalendar,((a,t)=>(0,l.wy)(((0,l.wg)(),(0,l.j4)(W,{key:t,clickable:""},{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.data),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.qta),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(v,{class:"col-2 text-black",side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{icon:"delete",flat:"",onClick:t=>e.deleteRow(a)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[Z]]))),128))])),_:1})])),_:1})])}var m=t(1959),c=t(5720),f=t(5616),p=t(2490),w=t(3245);const D=(0,l.aZ)({name:"PrenotaTamponePage",setup(){const e=(0,w.e)(),a=(0,m.iH)(null),t=(0,m.iH)(null),d=(0,m.iH)([]),o=(0,m.iH)({data:"",qta:""});p.db.collection("calendari").where("id_laboratorio","==",e.value.id).where("data",">",c.Z.firestore.Timestamp.fromDate(new Date)).get().then((e=>{const a=[];e.forEach((e=>{a.push({data:f.ZP.formatDate(e.data().data.toDate(),"DD/MM/YYYY"),qta:e.data().qta})})),d.value=a}));const r=f.ZP.formatDate(Date.now(),"YYYY/MM/DD"),u=e=>e>=r,i=e=>f.ZP.extractDate(e,"DD/MM/YYYY")>=new Date,n=e=>d.value.findIndex((a=>a.data===e)),s=async()=>{const r=n(o.value.data);if(-1!==r){d.value[r].qta=o.value.qta;const a=await p.db.collection("calendari").where("id_laboratorio","==",e.value.id).where("data","==",c.Z.firestore.Timestamp.fromDate(f.ZP.extractDate(o.value.data,"DD/MM/YYYY"))).get();a.forEach((e=>{p.db.collection("calendari").doc(e.id).update({qta:o.value.qta})}))}else d.value.push({...o.value}),await p.db.collection("calendari").add({id_laboratorio:e.value.id,data:c.Z.firestore.Timestamp.fromDate(f.ZP.extractDate(o.value.data,"DD/MM/YYYY")),qta:parseInt(o.value.qta)});o.value.data=f.ZP.formatDate(f.ZP.addToDate(f.ZP.extractDate(o.value.data,"DD/MM/YYYY"),{days:1}),"DD/MM/YYYY"),o.value.qta="",await(0,l.Y3)(),a.value.resetValidation(),t.value.focus()},D=a=>{const t=n(a.data);p.db.collection("calendari").where("id_laboratorio","==",e.value.id).where("data","==",c.Z.firestore.Timestamp.fromDate(f.ZP.extractDate(a.data,"DD/MM/YYYY"))).get().then((e=>{e.forEach((e=>{p.db.collection("calendari").doc(e.id).delete()}))})),d.value.splice(t,1)},Y=(0,l.Fl)((()=>{const e=[...d.value];return e.sort(((e,a)=>f.ZP.extractDate(e.data,"DD/MM/YYYY")-f.ZP.extractDate(a.data,"DD/MM/YYYY"))),e}));return{formRef:a,qtaRef:t,limitDateFn:u,checkMajToday:i,register:o,sortedCalendar:Y,addRow:s,deleteRow:D}}});var Y=t(8689),v=t(7011),_=t(3414),W=t(2035),b=t(2350),q=t(4842),Z=t(4554),M=t(3944),h=t(6915),k=t(8240),g=t(6489),x=t(7518),P=t.n(x);D.render=s;const y=D;P()(D,"components",{QForm:Y.Z,QList:v.Z,QItem:_.Z,QItemSection:W.Z,QItemLabel:b.Z,QInput:q.Z,QIcon:Z.Z,QPopupProxy:M.Z,QDate:h.Z,QBtn:k.Z}),P()(D,"directives",{Ripple:g.Z})}}]);